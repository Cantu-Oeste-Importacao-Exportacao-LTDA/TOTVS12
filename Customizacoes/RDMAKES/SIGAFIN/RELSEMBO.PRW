#INCLUDE "rwmake.ch"
#INCLUDE "protheus.ch"
#INCLUDE "topconn.ch"
#INCLUDE "report.ch"


/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบPrograma  ณRELSEMBO บAutor ณEdison Greski Barbieri บ Data ณ 31/10/2016 บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณRelat๓rio contendo informa็๕es de notas sem                 บฑฑ
ฑฑบ          ณboletos.                                                    บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ Financeiro                                                 บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
*/                                                                

User Function RELSEMBO()
Private oReport
Private cFile		:= "RELSEMBO"
Private cPerg		:= "RELSEMBO01"
Private cTitle		:= "Notas sem boletos"
Private cHelp		:= "Este relat๓rio ter por objetivo detalhar as notas emitidas sem boleto."
Private cAliasTMP	:= GetNextAlias()


//
//Executa fun็๕es de verifica็ใo do grupo de perguntas utilizadoณ
//
VldPerg(cPerg)  // Chama funcao VldPerg para Verificar se as Perguntas existem no SX1, se nao existir cria

PutSX1(cPerg)
PERGUNTE(cPerg,.F.)

//
//Cria o objeto pertinente ao processamento do relat๓rioณ
//
oReport := REL01()
oReport:PRINTDIALOG()

Return


Static Function REL01()

Local aOrder := {}

//
//Cria o componente de processamento do relat๓rioณ
//
oReport := TReport():New(cFile, cTitle, cPerg, {|oReport| REL01PRINT(oReport)}, cHelp,,"Todos os tํtulos")
oReport:SetLandscape()
oReport:EndReport(.F.)
oReport:SetTotalInLine(.F.)

//
//Cria a sessใo principal de CHAMADOS do relat๓rio	ณ
//
oSection1 := TRSection():New(oReport,"Notas sem boleto",{"SE5"})
TRCell():New(oSection1, "E1_FILIAL"		, "SE1", "Filial")
TRCell():New(oSection1, "E1_PREFIXO"   	, "SE1", "Prefํxo")
TRCell():New(oSection1, "E1_TIPO"       , "SE1", "Tipo")
TRCell():New(oSection1, "A1_FORMPAG"	, "SA1", "F. Pgt")
TRCell():New(oSection1, "A1_COD"	    , "SA1", "Cod. Cliente") 
TRCell():New(oSection1, "A1_LOJA"	    , "SA1", "Lj. Cliente")
TRCell():New(oSection1, "E1_NOMCLI"		, "SE1", "N. Cliente")
TRCell():New(oSection1, "E1_NUM"	    , "SE1", "Tํtulo")
TRCell():New(oSection1, "E1_PARCELA"    , "SE1", "Parcela")
TRCell():New(oSection1, "E1_VALOR"	    , "SE1", "R$ Tํtulo")
TRCell():New(oSection1, "E1_EMISSAO"	, "SE1", "Emissใo")
TRCell():New(oSection1, "E1_VENCREA"	, "SE1", "Vcto Real")


Return oReport

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบPrograma  ณREL01PRINT     บAutor  ณEdison        บ Data ณ 31/10/2016   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณ                                                            บฑฑ
ฑฑบ          ณ                                                            บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ AP                                                        บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
*/
Static Function REL01PRINT(oReport)
Local oSection1		:= oReport:Section(1)
Local oSection2		:= oReport:Section(1):Section(1)          



//
//Efetua montagem da Query da SESSรO DE CHAMADOS ณ
//
BEGIN REPORT QUERY oSection1
	
	BEGINSQL Alias cAliasTMP
			Column E1_EMISSAO as Date  
			Column E1_VENCREA as Date  
			
	 SELECT 
           E1.E1_FILIAL,
		   E1.E1_PREFIXO,
		   E1.E1_TIPO,
		   A1.A1_FORMPAG,
		   A1.A1_COD,
		   A1.A1_LOJA,	
		   E1.E1_NOMCLI,
		   E1.E1_NUM,	  
		   E1.E1_PARCELA,
		   E1.E1_VALOR, 
		   E1.E1_EMISSAO,
		   E1.E1_VENCREA
           FROM %Table:SE1% E1
		           LEFT JOIN %Table:SA1% A1
				   ON  A1.A1_COD = E1.E1_CLIENTE 
				   AND A1.A1_LOJA = E1.E1_LOJA
				   	
		   WHERE  E1.%Notdel%      
				   AND A1.%Notdel%
				   AND E1.E1_PORTADO = ' '   
				   AND E1.E1_FILIAL >= %Exp:MV_PAR01% AND E1.E1_FILIAL	<= %Exp:MV_PAR02% 
		 		   AND E1.E1_PORTADO = ' '
				   AND A1.A1_FORMPAG = 'BO'
				   AND E1.E1_SALDO > 0
   		 		   AND E1.E1_EMISSAO >= %Exp:DTOS(MV_PAR03)% AND E1.E1_EMISSAO <= %Exp:DTOS(MV_PAR04)%
                   AND E1.E1_TIPO NOT IN ('RA','NCC','CH')
                   AND E1.E1_PREFIXO NOT IN ('TCD','NFD')

		
		   order by E1.E1_FILIAL
    ENDSQL
		
END REPORT QUERY oSection1

//
//Seta regra de contador do processamento	ณ
//

oReport:SetMeter((cAliasTMP)->(RECCOUNT()))

//
//Executa a impressใo das sess๕es do relat๓rio	ณ
//
oSection1:Print() 

Return

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบPrograma  ณAJUSTASX1  บAutor  ณMarcelo           บ Data ณ 06/06/2014   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณFun็ใo responsแvel pela cria็ใo do grupo de perguntas utili-บฑฑ
ฑฑบ          ณzado como parโmetros do relat๓rio.                          บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณEspecifico Treinamento                                      บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
*/
Static Function VldPerg(cPerg)
PutSx1(cPerg,"01","Filial  De        ?"      ,"Filial De         ?"         ,"Filial De           ?"      ,"MV_CH1"  ,"C",02,0,0 ,"G","","   ", "", "","MV_PAR01")
PutSx1(cPerg,"02","Filial At้        ?"      ,"Filial At้        ?"         ,"Filial At้          ?"      ,"MV_CH2"  ,"C",02,0,0 ,"G","","   ","",""  ,"MV_PAR02")
PutSX1(cPerg,"03","Emissใo de   	 ?"	     ,"Emissใo de    	 ?"         ,"Emissใo de          ?"      ,"MV_CH3"  ,"D",008,0,0,"G","","","",""     ,"MV_PAR03","","","","","","","","","", "", "", "", "", "", "", "", {"","","",""}, {"","","",""}, {"","",""}, "")
PutSX1(cPerg,"04","Emissใo At้  	 ?"	     ,"Emissใo At้  	 ?"         ,"Emissใo At้         ?"      ,"MV_CH4"  ,"D",008,0,0,"G","","","",""     ,"MV_PAR04","","","","","","","","","", "", "", "", "", "", "", "", {"","","",""}, {"","","",""}, {"","",""}, "")



Return